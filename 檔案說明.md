# 📁 專案檔案說明

## 🎯 核心程式檔案 (src/)

### 主要入口
- **`main.py`** - LINE Bot 主程式入口,啟動 FastAPI 伺服器
- **`test_cli.py`** - 命令列測試介面,不需要 LINE Bot 即可測試
- **`test_web.py`** - 網頁測試介面,提供 Web UI 測試

### 核心功能模組
- **`config.py`** - 設定管理,讀取環境變數和配置
- **`data_processor.py`** - 處理信用卡 CSV 資料,轉換為 RAG 格式
- **`vector_store.py`** - 向量資料庫管理 (ChromaDB + HuggingFace Embeddings)
- **`rag_engine.py`** - RAG 推薦引擎,結合向量搜尋和 LLM 生成回應
- **`user_manager.py`** - 使用者資料管理 (SQLite + SQLAlchemy)
- **`line_bot.py`** - LINE Bot 整合邏輯
- **`prompt_templates.py`** - LLM 提示詞模板

### 工具腳本
- **`init_db.py`** - 初始化向量資料庫,必須先執行
- **`check_models.py`** - 檢查 Google API Key 支援的模型

### 資料庫檔案
- **`creditcard.db`** - SQLite 資料庫,儲存使用者和信用卡清單
- **`chroma_db/`** - ChromaDB 向量資料庫目錄

---

## 📄 專案根目錄檔案

### 資料檔案
- **`信用卡資料模板.csv`** - 信用卡資料來源 (15 張卡片)
- **`信用卡資料模板.xlsx`** - Excel 版本,方便編輯
- **`create_excel.py`** - CSV 轉 Excel 工具

### 設定檔案
- **`requirements.txt`** - Python 依賴套件清單
- **`.env`** - 環境變數設定 (包含 API Keys)
- **`.env.example`** - 環境變數範例
- **`.gitignore`** - Git 忽略清單

### 文件
- **`README.md`** - 專案說明
- **`TEST_GUIDE.md`** - 測試指南
- **`DEPLOYMENT.md`** - 部署指南
- **`TROUBLESHOOTING.md`** - 疑難排解
- **`VENV_GUIDE.md`** - 虛擬環境設定指南

### Docker
- **`Dockerfile`** - Docker 容器設定

---

## 🗑️ 可移除的檔案

以下檔案已不再需要,可以安全刪除:

- **`start.bat`** - Windows 啟動腳本 (已有更簡單的方式)
- **`start.sh`** - Linux/Mac 啟動腳本 (已有更簡單的方式)

---

## 🚀 如何啟動系統

### 前置準備 (只需執行一次)

```bash
# 1. 安裝依賴
pip install -r requirements.txt

# 2. 初始化向量資料庫
cd src
python init_db.py
```

### 啟動方式

#### 🧪 方式 1: 命令列測試 (推薦新手)
```bash
cd src
python test_cli.py
```
- 最簡單的測試方式
- 直接在終端機互動
- 不需要 LINE Bot 設定

#### 🌐 方式 2: 網頁介面測試
```bash
cd src
python test_web.py
```
- 開啟瀏覽器訪問 `http://localhost:8000`
- 提供圖形化介面

#### 📱 方式 3: LINE Bot 正式模式
```bash
cd src
python main.py
```
- 需要先設定 `.env` 中的 LINE Bot 憑證
- 需要使用 ngrok 或部署到雲端

---

## 📊 系統架構

```
使用者查詢
    ↓
RAG Engine (rag_engine.py)
    ↓
Vector Store (vector_store.py) → 搜尋相關卡片
    ↓
User Manager (user_manager.py) → 過濾使用者持有的卡片
    ↓
LLM (Gemini 2.5 Flash) → 生成推薦回應
    ↓
回傳結果
```

---

## 🔧 常用維護指令

```bash
# 重建向量資料庫 (更新信用卡資料後)
cd src
python init_db.py

# 轉換 CSV 為 Excel
python create_excel.py

# 檢查支援的 AI 模型
cd src
python check_models.py
```

---

## 💡 快速開始

最快的測試方式:
```bash
cd src
python test_cli.py
```

然後輸入:
- `add 台新Richart卡` (新增卡片)
- `我要去加油` (查詢推薦)
